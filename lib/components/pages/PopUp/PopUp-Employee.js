var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _core=require("@material-ui/core");var _Toast=_interopRequireDefault(require("../../../utils/Toast"));var _createEmployee=_interopRequireDefault(require("../../../services/createEmployee"));var _editEmployee=_interopRequireDefault(require("../../../services/editEmployee"));var _this=this,_jsxFileName="/home/guzman/ReactJSProjects/weblanatax/src/components/pages/PopUp/PopUp-Employee.jsx";var SimpleDialog=function SimpleDialog(_ref){var _onClose=_ref.onClose,open=_ref.open,title=_ref.title,data=_ref.data,create=_ref.create;var _useState=(0,_react.useState)(data.uid),_useState2=(0,_slicedToArray2.default)(_useState,2),uid=_useState2[0],setUid=_useState2[1];var _useState3=(0,_react.useState)(data.fullname),_useState4=(0,_slicedToArray2.default)(_useState3,2),fullname=_useState4[0],setFullname=_useState4[1];var _useState5=(0,_react.useState)(data.lastsign),_useState6=(0,_slicedToArray2.default)(_useState5,2),lastsign=_useState6[0],setLastsign=_useState6[1];var _useState7=(0,_react.useState)(data.type),_useState8=(0,_slicedToArray2.default)(_useState7,2),type=_useState8[0],setType=_useState8[1];var _useState9=(0,_react.useState)(data.state),_useState10=(0,_slicedToArray2.default)(_useState9,2),state=_useState10[0],setState=_useState10[1];var _useState11=(0,_react.useState)(''),_useState12=(0,_slicedToArray2.default)(_useState11,2),email=_useState12[0],setEmail=_useState12[1];var _useState13=(0,_react.useState)([{value:'receptionist',label:'Recepcionista'},{value:'advicer',label:'Consultor'},{value:'supervisor',label:'Supervisor'}]),_useState14=(0,_slicedToArray2.default)(_useState13,2),types=_useState14[0],setTypes=_useState14[1];var handleChange=function handleChange(event){setType(event.target.value);};var handleClose=function handleClose(){_onClose();};var reset=function reset(){setUid(data.uid);setFullname(data.fullname);setLastsign(data.lastsign);setType(data.type);setState(data.state);};var validation=function validation(){if(fullname.length==0||type.length==0){(0,_Toast.default)("Todos los campos son requeridos.","error");}else if(email.length==0&&create){(0,_Toast.default)("Todos los campos son requeridos.","error");}else if(types.includes(type)){(0,_Toast.default)("Seleccione un rol valido.","error");}else{var _data={uid:uid,fullname:fullname,lastsign:lastsign,type:type,state:state};if(create){setEmail(email.toLowerCase());_data.lastsign=new Date();addEmployee(_data);(0,_Toast.default)("Usuario creado con exito","success");}else{editEmployee(_data);(0,_Toast.default)("Usuario modificado con exito","success");}handleClose();}};var addEmployee=function addEmployee(data){return _regenerator.default.async(function addEmployee$(_context){while(1){switch(_context.prev=_context.next){case 0:data.uid=email;_context.prev=1;_context.next=4;return _regenerator.default.awrap((0,_createEmployee.default)(data));case 4:_context.next=10;break;case 6:_context.prev=6;_context.t0=_context["catch"](1);console.error("Error al crear empleado: ",_context.t0);(0,_Toast.default)("Error al crear empleado.","error");case 10:case"end":return _context.stop();}}},null,null,[[1,6]],Promise);};var editEmployee=function editEmployee(data){return _regenerator.default.async(function editEmployee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _regenerator.default.awrap((0,_editEmployee.default)(data));case 3:_context2.next=9;break;case 5:_context2.prev=5;_context2.t0=_context2["catch"](0);console.error("Error al editar empleado: ",_context2.t0);(0,_Toast.default)("Error al editar empleado.","error");case 9:case"end":return _context2.stop();}}},null,null,[[0,5]],Promise);};return _react.default.createElement(_core.Dialog,{onClose:function onClose(){return _onClose();},onRendered:reset,"aria-labelledby":"simple-dialog-title",open:open,__self:_this,__source:{fileName:_jsxFileName,lineNumber:104,columnNumber:9}},_react.default.createElement(_core.DialogTitle,{id:"simple-dialog-title",__self:_this,__source:{fileName:_jsxFileName,lineNumber:106,columnNumber:13}},title),_react.default.createElement(_core.DialogContent,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:107,columnNumber:13}},_react.default.createElement(_core.DialogContentText,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:108,columnNumber:17}},"Informaci\xF3n del empleado:"),_react.default.createElement(_core.TextField,{margin:"dense",id:"Fullname",label:"Nombre",defaultValue:data.fullname,required:true,fullWidth:true,onChange:function onChange(e){return setFullname(e.target.value);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:111,columnNumber:17}}),create&&_react.default.createElement(_react.default.Fragment,null,_react.default.createElement(_core.TextField,{margin:"dense",id:"Email",label:"Email",type:"email",fullWidth:true,onChange:function onChange(e){return setEmail(e.target.value);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:122,columnNumber:17}}),_react.default.createElement(_core.TextField,{id:"Type",select:true,label:"Rol",required:true,fullWidth:true,defaultValue:data.type,value:type,onChange:handleChange,__self:_this,__source:{fileName:_jsxFileName,lineNumber:130,columnNumber:17}},types.map(function(option){return _react.default.createElement(_core.MenuItem,{key:option.value,value:option.value,__self:_this,__source:{fileName:_jsxFileName,lineNumber:141,columnNumber:21}},option.label);})))),_react.default.createElement(_core.DialogActions,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:148,columnNumber:13}},_react.default.createElement(_core.Button,{onClick:handleClose,color:"primary",__self:_this,__source:{fileName:_jsxFileName,lineNumber:149,columnNumber:17}},"Cancel"),_react.default.createElement(_core.Button,{onClick:validation,color:"primary",__self:_this,__source:{fileName:_jsxFileName,lineNumber:152,columnNumber:17}},create?'Crear':'Editar')));};var _default=SimpleDialog;exports.default=_default;